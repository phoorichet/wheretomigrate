
<div id="panel">
  <form id="mainform">
    <h1>Migrant Heaven</h1>
    <form id="mainForm">
      View factor:
      <select name="factorList">
        <option value="jobs">Job openings</option>
        <option value="crime">Crime rates</option>
        <option value="costoflivings">Cost of livings</option>
        <option value="races">Races</option>
      </select>
    </form>
  </form>
</div>
<div id="map-canvas"></div>

<script>

  var data;

  function initialize() {
    var initLatLng = new google.maps.LatLng(39.061849,-97.697296); // USA
    map = new google.maps.Map(document.getElementById('map-canvas'), {
      zoom: 5,
      center: initLatLng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    getData();
  }

  function getData() {
    data = [
      {
        lat: 39.061849,
        lng: -97.697296,
        size: 1,
      },
      {
        lat: 43.229195,
        lng: -110.177765,
        size: 0.8,
      },
    ];
    // timestamp = new Date().getTime()/1000;
    // $.ajax({
    //   url: "?callback=?",
    //   cache: false,
    //   data: {
    //     'method': 'getData', 
    //     'event_id': EVENT_ID, 
    //     'timestamp': timestamp, 
    //     'token': hex_md5(API_KEY+timestamp),
    //   },
    //   success: function (data, textStatus, jqXHR) {
    //     updateMap(data);
    //   },
    //   dataType: 'jsonp',
    //   crossDomain: true,
    // });

    updateMap(data);
  }

  var clusterMarkers = [];
  function updateMap(data) {
    // Clear cluster markers
    for (i=0; i<clusterMarkers.length; i++) {
      clusterMarkers[i].setMap(null);
    }
    clusterMarkers = [];

    for (var i=0; i<data.length; i++) {
      clusterMarkers[i] = {}; 
      
      // Draw device's position
      clusterMarkers[i] = new google.maps.Circle({
        map: map,
        // strokeColor: color[data[i].member_count],
        strokeColor: '#f00',
        strokeOpacity: 1.0,
        strokeWeight: 1,
        // fillColor: color[data[i].member_count],
        fillColor: '#0f0',
        fillOpacity: 0.2,
        center: new google.maps.LatLng(data[i].lat, data[i].lng),
        radius: parseInt(data[i].size*100),
      });
    }
  }

  /* Initial Google Maps after the page is loaded */
  google.maps.event.addDomListener(window, 'load', initialize);

</script>